var MM=window.MM||{};!function(){MM.voiceNavigator=MM.voiceNavigator||{},MM.loader=MM.loader||{},MM.loader.rootURL=MM.loader.rootURL||"https://developer.expectlabs.com/public/sdks/";var e={$mm:!1,$mm_iframe:!1,is_init:!1,on_init:function(){},init:function(){var t=this,o=document.createElement("div");o.setAttribute("id","mindmeld-modal"),document.body.insertBefore(o,document.body.childNodes[0]),t.$mm=t.el(o);for(var i=document.getElementsByClassName("mm-voice-nav-init"),n=function(e){e.preventDefault(),MM.voiceNavigator.showModal()},a=0;a<i.length;a++)this.el(i[a]).click(n);for(var c=document.getElementsByClassName("mm-voice-nav-text-init"),d=function(e){if(13===e.which){var t=e.target.value;MM.voiceNavigator.showModal(t)}},r=0;r<c.length;r++)this.el(c[r]).keypress(d);t.set_initialized(),t.el(window).on("message",function(t){"mindmeld"==t.data.source&&"close"==t.data.action&&e.$mm.removeClass("on")})},set_initialized:function(){this.is_init=!0,this.on_init()},postMessage:function(e,t){var o=document.getElementById("mindmeld-iframe").contentWindow;o.postMessage({action:e,source:"mindmeld",data:t},"*")},contentLoaded:function(e){var t=window,o=!1,i=!0,n=t.document,a=n.documentElement,c=n.addEventListener?"addEventListener":"attachEvent",d=n.addEventListener?"removeEventListener":"detachEvent",r=n.addEventListener?"":"on",s=function(i){("readystatechange"!=i.type||"complete"==n.readyState)&&(("load"==i.type?t:n)[d](r+i.type,s,!1),!o&&(o=!0)&&e.call(t,i.type||i))},l=function(){try{a.doScroll("left")}catch(e){return void setTimeout(l,50)}s("poll")};if("complete"==n.readyState)e.call(t,"lazy");else{if(n.createEventObject&&a.doScroll){try{i=!t.frameElement}catch(M){}i&&l()}n[c](r+"DOMContentLoaded",s,!1),n[c](r+"readystatechange",s,!1),t[c](r+"load",s,!1)}},el:function(e){return{on:function(t,o){e.addEventListener?e.addEventListener(t,o,!1):e.attachEvent&&e.attachEvent("on"+t,o)},click:function(e){this.on("click",e)},keypress:function(e){this.on("keypress",e)},removeClass:function(t){e.className=e.className.replace(new RegExp("(^|\\s+)"+t+"(\\s+|$)","g"),"$1")},addClass:function(t){e.className=e.className+" "+t},remove:function(){e.parentNode.removeChild(e)},el:function(){return e}}},convertToAbsolutePath:function(e){var t=document.createElement("a");return t.href=e,t.protocol+"//"+t.host+t.pathname+t.search+t.hash}};MM.voiceNavigator.showModal=function(t,o){if(e.is_init){var i;"undefined"!=typeof MM&&"undefined"!=typeof MM.widgets&&"undefined"!=typeof MM.widgets.config&&(MM.voiceNavigator.config=MM.widgets.config.voice||{},MM.voiceNavigator.config.appID=MM.widgets.config.appID,"undefined"!=typeof MM.widgets.config.cleanUrl&&(MM.voiceNavigator.config.cleanUrl=MM.widgets.config.cleanUrl),"undefined"!=typeof MM.widgets.config.fayeClientUrl&&(MM.voiceNavigator.config.fayeClientUrl=MM.widgets.config.fayeClientUrl),"undefined"!=typeof MM.voiceNavigator.config.cardTemplate&&(MM.voiceNavigator.config.cardLayout="custom"),"undefined"==typeof MM.voiceNavigator.config.cardLayout&&(MM.voiceNavigator.config.cardLayout="default"),"undefined"!=typeof MM.voiceNavigator.config.customCSSPath&&(MM.voiceNavigator.config.customCSSPath=e.convertToAbsolutePath(MM.voiceNavigator.config.customCSSPath)),"undefined"!=typeof MM.token&&"undefined"!=typeof MM.activeUserId&&null!==MM.activeUserId&&"undefined"!=typeof MM.activeSessionId&&null!==MM.activeSessionId&&(MM.voiceNavigator.config.mmCredentials={token:MM.token,userID:MM.activeUserId,sessionID:MM.activeSessionId}),MM.voiceNavigator.config.startQuery=void 0!==t&&""!==t?t:null),o&&e.$mm_iframe&&(i=document.getElementById("mindmeld-iframe"),i.parentNode.removeChild(i)),!e.$mm_iframe||o?(i=document.createElement("iframe"),i.setAttribute("frameBorder","0"),i.setAttribute("id","mindmeld-iframe"),i.setAttribute("allowtransparency","true"),i.setAttribute("src",MM.loader.rootURL+"widgets/voiceNavigator/modal/modal.min.html"),e.$mm_iframe=e.el(i),e.el(i).on("load",function(){if(e.postMessage("open",MM.voiceNavigator.config),"undefined"!=typeof MM.voiceNavigator.config.customCSSPath){var t=document.createElement("link");t.href=MM.voiceNavigator.config.customCSSPath,t.rel="stylesheet",t.type="text/css",i.contentWindow.document.head.appendChild(t)}if("undefined"!=typeof MM.voiceNavigator.config.customCSS){var o=document.createElement("style");o.type="text/css",o.innerText=MM.voiceNavigator.config.customCSS,i.contentWindow.document.head.appendChild(o)}}),e.$mm.el().appendChild(i)):e.postMessage("open",MM.voiceNavigator.config),e.$mm.addClass("on")}else e.on_init=function(){MM.voiceNavigator.showModal(t)}},MM.voiceNavigator.hideModal=function(){e.postMessage("close")},e.contentLoaded(function(){e.init()})}();